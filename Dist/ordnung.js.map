{
  "version": 3,
  "file": "Dist/ordnung.js",
  "sources": [
    "Source/ordnung/utils.js",
    "Source/ordnung/qvc/ExecutableResult.js",
    "Source/ordnung/qvc/Constraint.js",
    "Source/ordnung/qvc/Validator.js",
    "Source/ordnung/qvc/koExtensions.js",
    "Source/ordnung/qvc/Validatable.js",
    "Source/ordnung/qvc/Executable.js",
    "Source/ordnung/ajax.js",
    "Source/ordnung/qvc/ConstraintResolver.js",
    "Source/ordnung/errorHandler.js",
    "Source/ordnung/qvc.js",
    "Source/ordnung/spa/Outlet.js",
    "Source/ordnung/spa/whenContext.js",
    "Source/ordnung/spa/applyViewModels.js",
    "Source/ordnung/spa/hashNavigation.js",
    "Source/ordnung/spa/PageLoader.js",
    "Source/ordnung/spa/Templates.js",
    "Source/ordnung/proclaimWhen.js",
    "Source/ordnung/events.js",
    "Source/ordnung/spa.js",
    "Source/ordnung/ordnung.js",
    "Source/ordnung/qvc/constraints/NotEmpty.js",
    "Source/ordnung/qvc/constraints/Pattern.js"
  ],
  "names": [],
  "mappings": "AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvDA,ADwDA;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA,ADeA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChCA,ADiCA;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjJA,ADkJA;ACjJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzFA,AD0FA;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChDA,ADiDA;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzEA,AD0EA;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpFA,ADqFA;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrEA,ADsEA;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnFA,ADoFA;ACnFA;AACA;AACA;AACA;AACA,ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChEA,ADiEA;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "sourcesContent": [
    "\ndefine('ordnung/utils',[], function(){\r\n\treturn {\r\n\t\ttoArray: function(obj){\r\n\t\t\tvar array = [];\r\n\t\t\t// iterate backwards ensuring that length is an UInt32\r\n\t\t\tfor (var i = obj.length >>> 0; i--;) { \r\n\t\t\t\tarray[i] = obj[i];\r\n\t\t\t}\r\n\t\t\treturn array;\r\n\t\t},\r\n\t\textend: function(dst, src){\r\n\t\t\tsrc = src || {};\r\n\t\t\tdst = dst || {};\r\n\t\t\tfor(var i in src){\r\n\t\t\t\tdst[i] = src[i];\r\n\t\t\t}\r\n\t\t\treturn dst;\r\n\t\t},\r\n\t\tarrayToObject: function(array, func){\r\n\t\t\treturn array.reduce(function(collection, item){\r\n\t\t\t\tfunc(item, collection);\r\n\t\t\t\treturn collection;\r\n\t\t\t}, {});\r\n\t\t},\r\n\t\ttrim: function(word, character){\r\n\t\t\twhile(word.charAt(0) == character) word = word.substr(1);\r\n\t\t\twhile(word.charAt(word.length - 1) == character) word = word.substr(0, word.length - 1);\r\n\t\t\treturn word;\r\n\t\t},\r\n\t\tafter: function(word, character){\r\n\t\t\tvar index = word.indexOf(character);\r\n\t\t\tif(index < 0){\r\n\t\t\t\treturn \"\";\r\n\t\t\t}else{\r\n\t\t\t\treturn word.substr(index+1);\r\n\t\t\t}\r\n\t\t},\r\n\t\tpopTail: function(array){\r\n\t\t\treturn array.slice(0, -1);\r\n\t\t},\r\n\t\tstartsWith: function(word, character){\r\n\t\t\treturn word.charAt(0) === character;\r\n\t\t},\r\n\t\tendsWith: function(word, character){\r\n\t\t\treturn word.charAt(word.length - 1) === character;\r\n\t\t},\r\n\t\taddEventListener: function(element, event, listener, bubble){\r\n\t\t\tif('addEventListener' in element){\r\n\t\t\t\telement.addEventListener(event, listener, bubble);\r\n\t\t\t}else{\r\n\t\t\t\telement.attachEvent(\"on\"+event, listener);\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n});\r\n",
    "\ndefine('ordnung/qvc/ExecutableResult',[\"ordnung/utils\"], function(utils){\r\n\tfunction ExecutableResult(result){\r\n\t\t\r\n\t\tthis.success = false;\r\n\t\tthis.valid = false;\r\n\t\tthis.result = null;\r\n\t\tthis.exception = null;\r\n\t\tthis.violations = [];\r\n\t\r\n\t\tutils.extend(this, result);\r\n\t\r\n\t};\r\n\t\r\n\treturn ExecutableResult;\r\n});",
    "\ndefine('ordnung/qvc/Constraint',[], function(){\r\n\t\r\n\tfunction Constraint(type, attributes){\t\t\r\n\t\tthis.type = type;\r\n\t\tthis.attributes = attributes;\r\n\t\tthis.message = attributes.message;\r\n\t\t\r\n\t\t\r\n\t\tthis.init(type);\r\n\t}\r\n\t\t\r\n\tConstraint.prototype.init = function(type){\r\n\t\trequire([\"ordnung/qvc/constraints/\" + type], function(Tester){\r\n\t\t\tvar tester = new Tester(this.attributes);\r\n\t\t\tthis.validate = tester.isValid.bind(tester);\r\n\t\t}.bind(this));\r\n\t};\r\n\t\r\n\tConstraint.prototype.validate = function(value){\r\n\t\treturn true;//real test not loaded yet\r\n\t};\r\n\t\r\n\t\r\n\treturn Constraint;\r\n});",
    "\ndefine('ordnung/qvc/Validator',[\r\n\t\"ordnung/qvc/Constraint\", \r\n\t\"knockout\"\r\n], function(\r\n\tConstraint, \r\n\tko\r\n){\r\n\r\n\tfunction interpolate(message, attributes, value, name, path){\r\n\t\treturn message.replace(/\\{([^}]+)\\}/g, function(match, key){\r\n\t\t\tif(key == \"value\") return value;\r\n\t\t\tif(key == \"this.name\") return name;\r\n\t\t\tif(key == \"this.path\") return path;\r\n\t\t\tif(key in attributes) return attributes[key];\r\n\t\t\treturn match;\r\n\t\t});\r\n\t}\r\n\t\r\n\r\n\tfunction Validator(target, options){\r\n\t\tvar self = this;\r\n\t\t\r\n\t\tthis.constraints = [];\r\n\t\t\r\n\t\tthis.isValid = ko.observable(true);\r\n\t\tthis.message = ko.observable(\"\");\r\n\r\n\t\tthis.name = options && options.name;\r\n\t\tthis.path = options && options.path;\r\n\t}\r\n\t\r\n\tValidator.prototype.setConstraints = function(constraints){\r\n\t\tthis.constraints = constraints.map(function(constraint){\r\n\t\t\treturn new Constraint(constraint.name, constraint.attributes);\r\n\t\t});\r\n\t};\r\n\t\r\n\tValidator.prototype.reset = function(){\r\n\t\tthis.isValid(true);\r\n\t\tthis.message(\"\");\r\n\t};\r\n\t\r\n\tValidator.prototype.validate = function(value){\r\n\t\tif(this.constraints.length == 0){\r\n\t\t\tthis.reset();\r\n\t\t}else if(this.constraints.every(function (constraint) {\r\n\t\t\tif(constraint.validate(value)){\r\n\t\t\t\treturn true;\r\n\t\t\t}else{\r\n\t\t\t\tthis.isValid(false);\r\n\t\t\t\tthis.message(interpolate(constraint.message, constraint.attributes, value, this.name, this.path));\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}.bind(this))){\r\n\t\t\tthis.isValid(true);\r\n\t\t\tthis.message(\"\");\r\n\t\t}\r\n\t};\r\n\t\r\n\treturn Validator;\r\n});",
    "\ndefine('ordnung/qvc/koExtensions',[\"ordnung/qvc/Validator\", \"knockout\"], function(Validator, ko){\r\n\r\n\tif (ko != null) {\r\n\t\tko.bindingHandlers.validationMessageFor = {\r\n\t\t\tinit: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n\t\t\t\tvar value = valueAccessor();\r\n\t\t\t\tvar validator = value.validator;\r\n\t\t\t\tif (validator) {\r\n\t\t\t\t\tko.applyBindingsToNode(element, { hidden: validator.isValid, text: validator.message }, validator);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar attributes = Array.prototype.reduce.call(element.attributes, function(s,e){return s+\" \"+e.localName+\"=\\\"\"+e.value+\"\\\"\"}, \"\");\r\n\t\t\t\t\tthrow new Error(\"Could not bind `validationMessageFor` to value on element <\"+element.tagName.toLowerCase() + attributes +\">\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tko.extenders.validation = function (target, options) {\r\n\t\t\ttarget.validator = new Validator(target, options);\r\n\t\t\ttarget.subscribe(function (newValue) {\r\n\t\t\t\ttarget.validator.validate(newValue);\r\n\t\t\t});\r\n\t\t\treturn target;\r\n\t\t};\r\n\t\t\r\n\t\tko.bindingHandlers.command = ko.bindingHandlers.query = {\r\n\t\t\tinit: function (element, valueAccessor, allBindingAccessor, viewModel) {\r\n\t\t\t\tko.applyBindingsToNode(element, { click: valueAccessor() }, viewModel);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\r\n});",
    "\ndefine('ordnung/qvc/Validatable',[\"ordnung/utils\", \"ordnung/qvc/Validator\", \"knockout\", \"ordnung/qvc/koExtensions\"],function(utils, Validator, ko){\r\n\t\r\n\tfunction recursivlyExtendParameters(parameters, validatableFields, parents) {\r\n\t\tfor (var key in parameters) {\r\n\t\t\tvar property = parameters[key];\r\n\t\t\tvar path = parents.concat([key]);\r\n\t\t\tif (ko.isObservable(property)) {\r\n\t\t\t\tproperty.extend({\r\n\t\t\t\t\tvalidation: {\r\n\t\t\t\t\t\tname:key,\r\n\t\t\t\t\t\tpath:path.join(\".\")\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tvalidatableFields.push(property);\r\n\t\t\t}\r\n\t\t\tproperty = ko.utils.unwrapObservable(property);\r\n\t\t\tif (typeof property === \"object\") {\r\n\t\t\t\trecursivlyExtendParameters(property, validatableFields, path);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tfunction findField(fieldPath, parameters, errorMessage){\r\n\t\treturn fieldPath.split(\".\").reduce(function(object, name){\r\n\t\t\tvar path = object.path;\r\n\t\t\tvar field = ko.utils.unwrapObservable(object.field);\r\n\t\t\tif (name in field) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tfield: field[name],\r\n\t\t\t\t\tpath: path + \".\" + name\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(errorMessage + \": \" + fieldPath + \"\\n\" +\r\n\t\t\t\t\tname + \" is not a member of \" + path + \"\\n\" +\r\n\t\t\t\t\tpath + \" = `\" + ko.toJSON(field) + \"`\");\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tfield: parameters,\r\n\t\t\tpath: \"parameters\"\r\n\t\t}).field;\r\n\t}\r\n\r\n\r\n\r\n\t\r\n\tfunction applyViolationMessageToField(parameters, fieldPath, message) {\r\n\t\tvar object = findField(fieldPath, parameters, \"Error applying violation\");\r\n\t\t\r\n\t\tif (typeof message === \"string\" && \"validator\" in object) {\r\n\t\t\tobject.validator.isValid(false);\r\n\t\t\tobject.validator.message(message);\r\n\t\t}else{\r\n\t\t\tthrow new Error(\"Error applying violation\\n\"+fieldPath+\" is not validatable\\nit should be an observable\");\r\n\t\t}\r\n\t};\r\n\r\n\tfunction applyViolationMessageToValidatable(validatable, message) {\r\n\t\tvalidatable.validator.isValid(false);\r\n\t\tvar oldMessage = validatable.validator.message();\r\n\t\tvar newMessage = oldMessage.length == 0 ? message : oldMessage + \", \" + message;\r\n\t\tvalidatable.validator.message(newMessage);\r\n\t};\r\n\r\n\r\n\r\n\tfunction Validatable(name, parameters, constraintResolver){\r\n\t\tvar self = this;\r\n\t\t\r\n\t\tthis.validator = new Validator();\r\n\t\tthis.validatableFields = [];\r\n\t\tthis.validatableParameters = parameters;\r\n\t\t\r\n\t\t\r\n\t\tinit: {\r\n\t\t\trecursivlyExtendParameters(self.validatableParameters, self.validatableFields, []);\r\n\t\t\tif(constraintResolver)\r\n\t\t\t\tconstraintResolver.applyValidationConstraints(name, self);\r\n\t\t}\r\n\t}\r\n\t\r\n\tValidatable.prototype.isValid = function () {\r\n\t\treturn this.validatableFields.every(function(constraint){\r\n\t\t\treturn constraint.validator && constraint.validator.isValid();\r\n\t\t}) && this.validator.isValid();\r\n\t};\r\n\t\t\r\n\tValidatable.prototype.applyViolations = function(violations){\r\n\t\tviolations.forEach(function(violation){\r\n\t\t\tvar message = violation.message;\r\n\t\t\tvar fieldName = violation.fieldName;\r\n\t\t\tif (fieldName.length > 0) {\r\n\t\t\t\t//one of the fields violates a constraint\r\n\t\t\t\tapplyViolationMessageToField(this.validatableParameters, fieldName, message);\r\n\t\t\t} else {\r\n\t\t\t\t//the validatable violates a constraint\r\n\t\t\t\tapplyViolationMessageToValidatable(this, message);\r\n\t\t\t}\r\n\t\t}.bind(this));\r\n\t};\r\n\t\r\n\tValidatable.prototype.applyConstraints = function(fields){\r\n\t\tvar parameters = this.validatableParameters;\r\n\t\t\r\n\t\tfields.forEach(function(field){\r\n\t\t\tvar fieldName = field.name;\r\n\t\t\tvar constraints = field.constraints;\r\n\t\t\t\r\n\t\t\tvar object = findField(fieldName, parameters, \"Error applying constraints to field\");\r\n\t\t\t\r\n\t\t\tif (ko.isObservable(object) && \"validator\" in object) {\r\n\t\t\t\tobject.validator.setConstraints(constraints);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"Error applying constraints to field: \" + fieldName + \"\\n\" +\r\n\t\t\t\t\t\"It is not an observable or is not extended with a validator. \\n\" +\r\n\t\t\t\t\tfieldName + \"=`\" + ko.toJSON(object) + \"`\");\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\tValidatable.prototype.validate = function(){\r\n\t\tthis.validator.validate(true);\r\n\t\tif (this.validator.isValid()) {\r\n\t\t\tthis.validatableFields.forEach(function(constraint){\r\n\t\t\t\tvar validator = constraint.validator;\r\n\t\t\t\tif (validator) {\r\n\t\t\t\t\tvalidator.validate(constraint());\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\t\r\n\tValidatable.prototype.clearValidationMessages = function () {\r\n\t\tthis.validator.reset();\r\n\t\tthis.validatableFields.forEach(function(constraint){\r\n\t\t\tvar validator = constraint.validator;\r\n\t\t\tif (validator) {\r\n\t\t\t\tvalidator.reset();\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\t\r\n\t\r\n\treturn Validatable;\r\n});",
    "\ndefine('ordnung/qvc/Executable',[\"ordnung/qvc/ExecutableResult\", \"ordnung/qvc/Validatable\", \"ordnung/utils\", \"knockout\"], function(ExecutableResult, Validatable, utils, ko){\r\n\r\n\tfunction Executable(name, type, parameters, callbacks, qvc){\r\n\t\tvar self = this;\r\n\t\t\r\n\t\tthis.name;\r\n\t\tthis.type;\r\n\t\tthis.isBusy = ko.observable(false);\r\n\t\tthis.hasError = ko.observable(false);\r\n\t\tthis.result = new ExecutableResult();\r\n\t\t\r\n\t\tthis.parameters = {};\r\n\t\tthis.callbacks = {\r\n\t\t\tbeforeExecute: function () {},\r\n\t\t\tcanExecute: function(){return true;},\r\n\t\t\terror: function () {},\r\n\t\t\tsuccess: function () {},\r\n\t\t\tresult: function(){},\r\n\t\t\tcomplete: function () {}\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\tthis.execute = function () {\r\n\t\t\tif (self.onBeforeExecute() === false) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tqvc.execute(self);\r\n\t\t};\r\n\r\n\t\tthis.onBeforeExecute = function () {\r\n\t\t\t\r\n\t\t\tif (self.isBusy()) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tself.hasError(false);\r\n\t\t\t\r\n\t\t\tself.callbacks.beforeExecute();\r\n\t\t\t\r\n\t\t\tself.validate();\r\n\t\t\tif (!self.isValid()) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (self.callbacks.canExecute() === false) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tself.isBusy(true);\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\tthis.onError = function () {\r\n\t\t\tself.hasError(true);\r\n\t\t\tif(\"violations\" in self.result && self.result.violations != null)\r\n\t\t\t\tself.applyViolations(self.result.violations);\r\n\t\t\tself.callbacks.error(self.result);\r\n\t\t};\r\n\r\n\t\tthis.onSuccess = function () {\r\n\t\t\tself.hasError(false);\r\n\t\t\tself.clearValidationMessages();\r\n\t\t\tself.callbacks.success(self.result);\r\n\t\t\tself.callbacks.result(self.result.result);\r\n\t\t};\r\n\r\n\t\tthis.onComplete = function () {\r\n\t\t\tif (!self.hasError()) {\r\n\t\t\t\tself.callbacks.complete(self.result);\r\n\t\t\t\tself.clearValidationMessages();\r\n\t\t\t}\r\n\t\t\tself.isBusy(false);\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\tinit: {\r\n\t\t\tself.name = name;\r\n\t\t\tself.type = type;\r\n\t\t\tutils.extend(self.parameters, parameters);\r\n\t\t\tutils.extend(self.callbacks, callbacks);\r\n\t\t\tutils.extend(self, new Validatable(self.name, self.parameters, qvc.constraintResolver));\r\n\t\t}\r\n\t}\r\n\t\r\n\tExecutable.Command = \"command\";\r\n\tExecutable.Query = \"query\";\r\n\t\r\n\treturn Executable;\r\n});",
    "\ndefine('ordnung/ajax',[], function(){\r\n\tfunction dataToParams(data){\r\n\t\tvar params = []\r\n\t\tfor(var key in data){\r\n\t\t\tvar value = data[key];\r\n\t\t\tparams.push(encodeURIComponent(key) + \"=\" + encodeURIComponent(value));\r\n\t\t}\r\n\t\treturn params.join(\"&\");\r\n\t}\r\n\r\n\tfunction addParamToUrl(url, name, value){\r\n\t\treturn url + (url.match(/\\?/) ? (url.match(/&$/) ? \"\" : \"&\") : \"?\") + encodeURIComponent(name) + \"=\" + encodeURIComponent(value);\r\n\t}\r\n\r\n\tfunction addParamsToUrl(url, data){\r\n\t\tvar params = dataToParams(data);\r\n\t\treturn url + (url.match(/\\?/) ? (url.match(/&$/) ? \"\" : (params.length > 0 ? \"&\" : \"\")) : \"?\") + params;\r\n\t}\r\n\r\n\tfunction addToPath(url, segment){\r\n\t\treturn url + (url.match(/\\/$/) ? \"\" : \"/\") + segment;\r\n\t}\r\n\r\n\tfunction cacheBust(url){\r\n\t\treturn addParamToUrl(url, \"cacheKey\", Math.floor(Math.random()*Math.pow(2,53)));\r\n\t}\r\n\r\n\tfunction ajax(url, object, method, callback){\r\n\t\tvar xhr = new XMLHttpRequest();\r\n\t\t\r\n\t\tvar isPost = (method === \"POST\");\r\n\t\tvar data = null;\r\n\t\t\r\n\t\tif(object){\r\n\r\n\t\t\tif(isPost){\r\n\t\t\t\tdata = dataToParams(object);\r\n\t\t\t} else {\r\n\t\t\t\turl = addParamsToUrl(url, object);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(isPost){\r\n\t\t\turl = cacheBust(url);\r\n\t\t}\r\n\r\n\t\txhr.open(method, url, true);\r\n\t\t\r\n\t\tif(isPost && data){\r\n\t\t\txhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n\t\t}\r\n\t\t\r\n\t\txhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n\t\t\r\n\t\txhr.onreadystatechange = function(){\r\n\t\t\tif(xhr.readyState == 4){\r\n\t\t\t\tcallback(xhr);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\txhr.send(data);\r\n\t\treturn xhr;\r\n\t}\r\n\r\n\tajax.addParamToUrl = addParamToUrl;\r\n\tajax.addParamsToUrl = addParamsToUrl;\r\n\tajax.addToPath = addToPath;\r\n\tajax.cacheBust = cacheBust;\r\n\r\n\r\n\treturn ajax;\r\n});",
    "\ndefine('ordnung/qvc/ConstraintResolver',[], function(){\r\n\r\n\r\n\tfunction findConstraint(name, constraints) {\r\n\t\tfor (var i = 0; i < constraints.length; i++) {\r\n\t\t\tif (constraints[i].name == name) {\r\n\t\t\t\treturn constraints[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction constraintsLoaded(name, fields){\r\n\t\tvar constraint = findConstraint(name, this.constraints);\r\n\t\tif(constraint){\r\n\t\t\tconstraint.validatables.forEach(function(validatable){\r\n\t\t\t\tvalidatable.applyConstraints(fields);\r\n\t\t\t});\r\n\t\t\tconstraint.fields = fields;\r\n\t\t\tconstraint.state = \"loaded\";\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tfunction ConstraintResolver(qvc){\r\n\t\tthis.qvc = qvc;\r\n\t\tthis.constraints = [];\r\n\t}\r\n\t\r\n\tConstraintResolver.prototype.applyValidationConstraints = function(name, validatable){\r\n\t\tvar constraint = findConstraint(name, this.constraints);\r\n\t\tif(constraint == false){\r\n\t\t\tthis.constraints.push({\r\n\t\t\t\tname: name,\r\n\t\t\t\tstate: \"loading\",\r\n\t\t\t\tvalidatables: [validatable]\r\n\t\t\t});\r\n\t\t\tthis.qvc.loadConstraints(name, constraintsLoaded.bind(this));\r\n\t\t}else{\r\n\t\t\tif(constraint.state === \"loading\"){\r\n\t\t\t\tconstraint.validatables.push(validatable);\r\n\t\t\t}else{\r\n\t\t\t\tvalidatable.applyConstraints(constraint.fields);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\treturn ConstraintResolver;\r\n});",
    "\ndefine('ordnung/errorHandler',[], function(){\r\n\treturn {\r\n\t\tonError: function(error){\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tthrow error;\r\n\t\t\t},1);\r\n\t\t}\r\n\t};\r\n});",
    "\ndefine('ordnung/qvc',[\r\n\t\"ordnung/qvc/Executable\", \r\n\t\"ordnung/qvc/ExecutableResult\", \r\n\t\"ordnung/utils\", \r\n\t\"ordnung/ajax\",\r\n\t\"ordnung/qvc/ConstraintResolver\",\r\n\t\"ordnung/errorHandler\",\r\n\t\"knockout\", \r\n\t\"ordnung/qvc/koExtensions\"], \r\n\tfunction(\r\n\t\tExecutable,\r\n\t\tExecutableResult,\r\n\t\tutils,\r\n\t\tajax,\r\n\t\tConstraintResolver,\r\n\t\terrorHandler,\r\n\t\tko){\r\n\t\r\n\tfunction QVC(){\r\n\r\n\t\tvar qvc = this;\r\n\r\n\t\tthis.constraintResolver = new ConstraintResolver(qvc);\r\n\r\n\t\tthis.execute = function(executable){\r\n\t\t\tvar parameters = ko.toJS(executable.parameters);\r\n\t\t\tvar data = {\r\n\t\t\t\tparameters: JSON.stringify(parameters),\r\n\t\t\t\tcsrfToken: qvc.config.csrf\r\n\t\t\t};\r\n\t\t\tvar url = ajax.addToPath(qvc.config.baseUrl, executable.type + \"/\" + executable.name);\r\n\t\t\tajax(url, data, \"POST\", function (xhr) {\r\n\t\t\t\tif (xhr.status === 200) {\r\n\t\t\t\t\texecutable.result = new ExecutableResult(JSON.parse(xhr.responseText || \"{}\"));\r\n\t\t\t\t\tif (executable.result.success === true) {\r\n\t\t\t\t\t\texecutable.onSuccess();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif(executable.result.exception && executable.result.exception.message){\r\n\t\t\t\t\t\t\terrorHandler.onError(executable.result.exception.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\texecutable.onError();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\texecutable.result = new ExecutableResult({exception: {message: xhr.responseText, cause: xhr}});\r\n\t\t\t\t\terrorHandler.onError(executable.result.exception.message);\r\n\t\t\t\t\texecutable.onError();\r\n\t\t\t\t}\r\n\t\t\t\texecutable.onComplete();\r\n\t\t\t});\r\n\t\t\r\n\t\t};\r\n\t\t\r\n\t\tthis.loadConstraints = function(name, callback){\r\n\t\t\tvar url = ajax.addToPath(qvc.config.baseUrl, \"constraints/\" + name);\r\n\t\t\tajax(url, null, \"GET\", function(xhr){\r\n\t\t\t\tif (xhr.status === 200) {\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tvar response = JSON.parse(xhr.responseText || \"{\\\"parameters\\\":[]}\");\r\n\t\t\t\t\t\tif(\"parameters\" in response == false){\r\n\t\t\t\t\t\t\tresponse.parameters = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(response.exception && response.exception.message){\r\n\t\t\t\t\t\t\terrorHandler.onError(response.exception.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\tvar response = {parameters: []};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcallback(name, response.parameters);\r\n\t\t\t\t}else{\r\n\t\t\t\t\terrorHandler.onError(xhr.responseText);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t\r\n\t\tthis.config = {\r\n\t\t\tbaseUrl: \"/\",\r\n\t\t\tcsrf: \"\"\r\n\t\t}\r\n\t};\r\n\r\n\tvar qvc = new QVC();\r\n\t\r\n\tfunction createExecutable(name, type, parameters, callbacks){\r\n\t\tif(name == null || name.length == 0)\r\n\t\t\tthrow new Error(type + \" is missing name\\nA \" + type + \" must have a name!\\nusage: createCommand('name', [parameters, callbacks])\");\r\n\t\r\n\t\tvar executable = new Executable(name, type, parameters || {}, callbacks || {}, qvc);\r\n\t\tvar execute = executable.execute.bind(executable);\r\n\t\texecute.isValid = ko.computed(function(){return executable.isValid(); });\r\n\t\texecute.isBusy = ko.computed(function(){return executable.isBusy();});\r\n\t\texecute.hasError = ko.computed(function(){return executable.hasError();});\r\n\t\texecute.success = function(callback){\r\n\t\t\texecutable.callbacks.success = callback;\r\n\t\t\treturn execute;\r\n\t\t};\r\n\t\texecute.error = function(callback){\r\n\t\t\texecutable.callbacks.error = callback;\r\n\t\t\treturn execute;\r\n\t\t};\r\n\t\texecute.beforeExecute = function(callback){\r\n\t\t\texecutable.callbacks.beforeExecute = callback;\r\n\t\t\treturn execute;\r\n\t\t};\r\n\t\texecute.canExecute = function(callback){\r\n\t\t\texecutable.callbacks.canExecute = callback;\r\n\t\t\treturn execute;\r\n\t\t};\r\n\t\texecute.result = function(){\r\n\t\t\tif(arguments.length == 1){\r\n\t\t\t\texecutable.callbacks.result = arguments[0];\r\n\t\t\t\treturn execute;\r\n\t\t\t}\r\n\t\t\treturn executable.result.result;\r\n\t\t};\r\n\t\texecute.complete = function(callback){\r\n\t\t\texecutable.callbacks.complete = callback;\r\n\t\t\treturn execute;\r\n\t\t};\r\n\t\texecute.clearValidationMessages = executable.clearValidationMessages.bind(executable);\r\n\t\texecute.validator = executable.validator;\r\n\t\t\r\n\t\treturn execute;\r\n\t}\r\n\t\r\n\treturn {\r\n\t\tcreateCommand: function(name, parameters, callbacks){\r\n\t\t\treturn createExecutable(name, Executable.Command, parameters, callbacks);\r\n\t\t},\r\n\t\tcreateQuery: function(name, parameters, callbacks){\r\n\t\t\treturn createExecutable(name, Executable.Query, parameters, callbacks);\r\n\t\t},\r\n\t\tconfig: function(config){\r\n\t\t\tutils.extend(qvc.config, config);\r\n\t\t}\r\n\t}\r\n});",
    "\ndefine('ordnung/spa/Outlet',[\r\n\t\"knockout\"\r\n], function(\r\n\tko\r\n){\r\n\r\n\tfunction Outlet(element, document){\r\n\t\tthis.element = element;\r\n\t\tthis.document = document || window.document;\r\n\t}\r\n\r\n\tOutlet.prototype.outletExists = function(){\r\n\t\treturn this.element != null;\r\n\t};\r\n\r\n\tOutlet.prototype.unloadCurrentPage = function(){\r\n\t\tko.cleanNode(this.element);\r\n\t\tthis.element.innerHTML = \"\";\r\n\t};\r\n\r\n\tOutlet.prototype.setPageContent = function(content){\r\n\t\tthis.element.innerHTML = content;\r\n\t};\r\n\r\n\tOutlet.prototype.getPageTitle = function(){\r\n\t\tvar titleMetaTag = this.element.querySelector(\"meta[name=title]\");\r\n\t\treturn (titleMetaTag && titleMetaTag.getAttribute(\"content\"));\r\n\t};\r\n\r\n\tOutlet.prototype.setDocumentTitle = function(title){\r\n\t\tthis.document.title = title;\r\n\t};\r\n\r\n\tOutlet.prototype.extractAndRunPageJavaScript = function(){\r\n\t\tvar scripts = this.element.querySelectorAll(\"script\");\r\n\t\tfor(var i=0; i<scripts.length; i++){\r\n\t\t\tscripts[i].parentNode.removeChild(scripts[i]);\r\n\t\t\tif(scripts[i].id === '') throw new Error(\"The script must have an id\");\r\n\t\t\tif(this.document.getElementById(scripts[i].id) == null){\r\n\t\t\t\tvar script = this.document.createElement(\"script\");\r\n\t\t\t\tscript.id = scripts[i].id;\r\n\t\t\t\tscript.text = scripts[i].textContent;\r\n\t\t\t\tthis.document.body.appendChild(script);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tOutlet.prototype.indicatePageIsLoading = function(){\r\n\t\tthis.element.setAttribute(\"data-loading\", \"true\");\r\n\t};\r\n\r\n\tOutlet.prototype.pageHasLoaded = function(){\r\n\t\tthis.element.setAttribute(\"data-loading\", \"false\");\r\n\t};\r\n\r\n\treturn Outlet;\r\n\r\n});",
    "\ndefine('ordnung/spa/whenContext',[\r\n\t\r\n], function(\r\n\t\r\n){\r\n\r\n\tfunction unsubscribe(event, reaction){\r\n\t\tevent.dont(reaction);\r\n\t}\r\n\r\n\tfunction subscribe(event, reaction){\r\n\t\tevent(reaction);\r\n\t\treturn event.dont.bind(null, reaction);\r\n\t}\r\n\r\n\tfunction whenSomething(){\r\n\t\tif(this.destroyed) throw new Error(\"This context has been destroyed!\");\r\n\r\n\t\tif(arguments.length == 0){\r\n\t\t\tvar childContext = createContext();\r\n\t\t\tthis.childContexts.push(childContext);\r\n\t\t\treturn childContext.when;\r\n\t\t}else if(arguments.length == 1 && typeof arguments[0] === \"function\"){\r\n\t\t\treturn {\r\n\t\t\t\tdont: unsubscribe.bind(null, arguments[0])\r\n\t\t\t}\r\n\t\t}else if(arguments.length == 2 && typeof arguments[1] === \"function\"){\r\n\t\t\tthis.eventSubscribers.push(subscribe(arguments[0], arguments[1]));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction thisIsDestroyed(reaction){\r\n\t\tthis.onDestroyListeners.push(reaction);\r\n\t}\r\n\r\n\tfunction destroyChildContexts(){\r\n\t\tvar context;\r\n\t\twhile(context = this.childContexts.pop())\r\n\t\t\tcontext.destroyContext();\r\n\t}\r\n\r\n\tfunction destroyContext(){\r\n\t\tvar subscriber, listener, context;\r\n\t\twhile(subscriber = this.eventSubscribers.pop())\r\n\t\t\tsubscriber();\r\n\t\twhile(listener = this.onDestroyListeners.pop())\r\n\t\t\tlistener();\r\n\t\twhile(context = this.childContexts.pop())\r\n\t\t\tcontext.destroyContext();\r\n\t\tthis.destroyed = true;\r\n\t}\r\n\r\n\tfunction createContext(){\r\n\t\tvar context = {\r\n\t\t\tdestroyed: false,\r\n\t\t\tonDestroyListeners: [],\r\n\t\t\tchildContexts: [],\r\n\t\t\teventSubscribers: []\r\n\t\t};\r\n\r\n\t\tvar when = whenSomething.bind(context);\r\n\r\n\t\twhen.thisIsDestroyed = thisIsDestroyed.bind(context);\r\n\r\n\t\twhen.destroyChildContexts = destroyChildContexts.bind(context);\r\n\r\n\t\treturn {\r\n\t\t\twhen: when,\r\n\t\t\tdestroyContext: destroyContext.bind(context)\r\n\t\t};\r\n\t}\r\n\r\n\treturn createContext().when;\r\n});",
    "\ndefine('ordnung/spa/applyViewModels',[\r\n\t\"ordnung/utils\",\r\n\t\"ordnung/errorHandler\",\r\n\t\"knockout\", \r\n\t\"when\", \r\n\t\"when/callbacks\"\r\n], function (\r\n\tutils, \r\n\terrorHandler,\r\n\tko, \r\n\twhen, \r\n\tcallbacks\r\n) {\r\n\r\n\r\n\tfunction getAttributes(target){\r\n\r\n\t\tvar viewModelName = target.getAttribute(\"data-viewmodel\");\r\n\t\tvar model = target.getAttribute(\"data-model\");\r\n\t\tif (model && model.indexOf(\"{\") == 0) {\r\n\t\t\tmodel = JSON.parse(model);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttarget: target,\r\n\t\t\tviewModelName: viewModelName,\r\n\t\t\tmodel: model\r\n\t\t};\r\n\t}\r\n\r\n\r\n\tfunction loadViewModel(data){\r\n\r\n\t\treturn callbacks.call(require, [\r\n\t\t\tdata.viewModelName\r\n\t\t]).then(function(ViewModel){\r\n\t\t\tdata.ViewModel = ViewModel;\r\n\t\t\treturn data;\r\n\t\t}, function(error){\r\n\t\t\terrorHandler.onError(new Error(\"could not load the following modules: \"+error.requireModules));\r\n\t\t\treturn null;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction applyViewModel(subscribe, data) {\r\n\t\ttry{\r\n\t\t\tvar viewModel = new data.ViewModel(data.model || {}, subscribe);\r\n\t\t\tko.applyBindings(viewModel, data.target);\r\n\t\t}catch(e){\r\n\t\t\terrorHandler.onError(e);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction viewModelLoadedSuccessfully(data){\r\n\t\treturn data != null && data.ViewModel != null;\r\n\t}\r\n\r\n\treturn function (domElement, subscribe) {\r\n\r\n\t\tdomElement = domElement || document.body;\r\n\r\n\t\tvar elementList = utils.toArray(domElement.querySelectorAll(\"*[data-viewmodel]\"));\r\n\r\n\t\tvar viewModelsLoaded = elementList.map(getAttributes).map(loadViewModel);\r\n\r\n\t\treturn when.all(viewModelsLoaded).then(function(list){\r\n\t\t\tlist.filter(viewModelLoadedSuccessfully).forEach(applyViewModel.bind(null, subscribe))\r\n\t\t});\r\n\t};\r\n});",
    "\ndefine('ordnung/spa/hashNavigation',[\r\n\t\"ordnung/utils\"\r\n],function(\r\n\t_\r\n){\r\n\r\n\r\n\t\r\n\tfunction newPath(currentPath, link, index){\r\n\t\tvar isRelative = _.startsWith(link, '/') === false;\r\n\t\tvar isFolder = _.endsWith(link, '/');\r\n\t\t\r\n\t\tif(link === \"/\"){\r\n\t\t\tvar path = [];\r\n\t\t}else if(link === \"\"){\r\n\t\t\tvar path = [index];\r\n\t\t}else{\r\n\t\t\tvar path = _.trim(link, \"/\").split(\"/\");\r\n\t\t}\r\n\r\n\t\tif(isFolder){\r\n\t\t\tpath.push(index);\r\n\t\t}\r\n\t\tif(isRelative){\r\n\t\t\tpath = _.popTail(currentPath).concat(path);\r\n\t\t}\r\n\r\n\t\tvar out = [];\r\n\r\n\t\tfor(var i = path.length>>>0; i--;){\r\n\t\t\tif(path[i] === \"\"){\r\n\t\t\t\tcontinue;\r\n\t\t\t}else if(path[i] === \".\"){\r\n\t\t\t\tcontinue;\r\n\t\t\t}else if(path[i] === \"..\") {\r\n\t\t\t\ti--;\r\n\t\t\t}else{\r\n\t\t\t\tout.unshift(path[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn out;\r\n\t}\r\n\r\n\tfunction hashChanged(config, onPageChanged, document){\r\n\r\n\t\tvar path = _.after(document.location.href, '#');\r\n\r\n\t\tvar isRelative = _.startsWith(path, '/') == false;\r\n\t\tvar isFolder = _.endsWith(path, '/');\r\n\r\n\t\tif(isRelative || isFolder){\r\n\t\t\tvar newHash = newPath(this.currentPath, path, config.index).join('/');\r\n\t\t\tdocument.location.replace(\"#/\" + newHash);\r\n\t\t}else{\r\n\t\t\tthis.currentPath = newPath(this.currentPath, path, config.index);\r\n\t\t\tonPageChanged(this.currentPath.join('/'), this.currentPath.map(function(p){return decodeURIComponent(p);}));\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\tfunction startHashNavigation(config, onPageChanged, doc, global){\r\n\t\tdoc = doc || document;\r\n\t\tglobal = global || window;\r\n\r\n\t\tvar state = {\r\n\t\t\tcurrentPath: []\r\n\t\t};\r\n\t\tvar onHashChanged = hashChanged.bind(state, config, onPageChanged, doc);\r\n\t\tonHashChanged();\r\n\t\t_.addEventListener(global, \"hashchange\", onHashChanged, false);\r\n\r\n\t\treturn {\r\n\t\t\tstop: function(){\r\n\t\t\t\tglobal.removeEventListener(\"hashchange\", onHashChanged, false);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\r\n\treturn {\r\n\t\tstart: startHashNavigation\r\n\t};\r\n\r\n});",
    "\ndefine('ordnung/spa/PageLoader',[\r\n\t\"ordnung/ajax\"\r\n], function(\r\n\tajax\r\n){\r\n\r\n\tfunction PageLoader(config){\r\n\t\tthis.pathToUrl = config && config.pathToUrl || function(a){ return a; };\r\n\t\tthis.cache = (config && 'cachePages' in config ? config.cachePages : true);\r\n\t\tthis.currentXHR = null;\r\n\t}\r\n\r\n\tPageLoader.prototype.loadPage = function(path, resolver){\r\n\r\n\t\tthis.abort();\r\n\r\n\t\tvar url = this.pathToUrl(path);\r\n\r\n\t\tif(this.cache === false)\r\n\t\t\turl = ajax.cacheBust(url);\r\n\r\n\t\tthis.currentXHR = ajax(url, {}, \"GET\", function(xhr){\r\n\t\t\tif(xhr.status === 200)\r\n\t\t\t\tresolver.resolve(xhr.responseText);\r\n\t\t\telse\r\n\t\t\t\tresolver.reject({error: xhr.status, content: xhr.responseText});\r\n\t\t});\r\n\t};\r\n\r\n\tPageLoader.prototype.abort = function(){\r\n\t\tif(this.currentXHR && this.currentXHR.readyState !== 4){\r\n\t\t\tthis.currentXHR.abort();\r\n\t\t}\r\n\t};\r\n\r\n\treturn PageLoader;\r\n});",
    "\ndefine('ordnung/spa/Templates',[\r\n\t\"ordnung/spa/PageLoader\",\r\n\t\"ordnung/utils\",\r\n\t\"when\"\r\n], function(\r\n\tPageLoader,\r\n\tutils,\r\n\twhen\r\n){\r\n\r\n\tfunction defaultConfig(){\r\n\t\treturn {\r\n\t\t\tpathToUrl: function(a){ return a; }\r\n\t\t}\r\n\t}\r\n\r\n\tfunction findTemplatesInDocument(doc){\r\n\r\n\t\tvar nodeList = doc.querySelectorAll(\"[type='text/page-template']\");\r\n\t\tvar nodes = utils.toArray(nodeList);\r\n\t\tvar templateList = nodes.map(function(template){\r\n\t\t\treturn {\r\n\t\t\t\tid: template.id.toLowerCase(),\r\n\t\t\t\tcontent: template.innerHTML\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\treturn utils.arrayToObject(templateList, function(item, object){\r\n\t\t\tobject[item.id] = item.content;\r\n\t\t});\r\n\t}\r\n\r\n\r\n\tfunction Templates(document, config){\r\n\t\tthis.pageLoader = new PageLoader(config || defaultConfig());\r\n\t\tthis.cachePages = (config && 'cachePages' in config ? config.cachePages : true)\r\n\t\tthis.templates = findTemplatesInDocument(document);\r\n\t}\r\n\r\n\tTemplates.prototype.getTemplate = function(path){\r\n\r\n\t\tthis.pageLoader.abort();\r\n\r\n\t\tvar normalizedPath = path.toLowerCase();\r\n\r\n\t\tif(normalizedPath in this.templates){\r\n\t\t\treturn when.resolve(this.templates[normalizedPath]);\r\n\t\t}else{\r\n\t\t\tvar deferred = when.defer();\r\n\r\n\t\t\tthis.pageLoader.loadPage(path, deferred.resolver);\r\n\t\t\t\r\n\t\t\treturn deferred.promise.then(function(content){\r\n\t\t\t\tif(this.cachePages)\r\n\t\t\t\t\tthis.templates[normalizedPath] = content;\r\n\t\t\t\t\r\n\t\t\t\treturn content;\r\n\t\t\t}.bind(this), function(notFound){\r\n\t\t\t\tvar errorTemplate = \"error\" + notFound.error;\r\n\t\t\t\tif(errorTemplate in this.templates){\r\n\t\t\t\t\treturn this.templates[errorTemplate];\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn notFound.content;\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t}\r\n\t};\r\n\r\n\treturn Templates;\r\n});",
    "\ndefine('ordnung/proclaimWhen',[], function () {\r\n\r\n\tfunction publish(name, subscribers, data) {\r\n\t\tsubscribers.forEach(function (item) {\r\n\t\t\titem.apply(item, data);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction subscribeTo(name, subscribers, subscriber) {\r\n\t\tvar index = subscribers.indexOf(subscriber);\r\n\t\tif(index < 0)\r\n\t\t\tsubscribers.push(subscriber);\r\n\t\treturn index < 0;\r\n\t}\r\n\t\r\n\tfunction unsubscribeFrom(name, subscribers, subscriber){\r\n\t\tvar index = subscribers.indexOf(subscriber);\r\n\t\tif(index >= 0)\r\n\t\t\tsubscribers.splice(index, 1);\r\n\t\treturn index >= 0;\r\n\t}\r\n\tfunction extendEvent(name, event){\r\n\t\tevent.subscribers = [];\r\n\t\tevent.subscribeSubscribers = [];\r\n\t\tevent.unsubscribeSubscribers = [];\r\n\r\n\t\tvar extendedEvent = function(){\r\n\t\t\tif(arguments.length == 1 && typeof arguments[0] === \"function\"){\r\n\t\t\t\tif(subscribeTo(name, event.subscribers, arguments[0]))\r\n\t\t\t\t\tpublish(name+\".isSubscribedTo\", event.subscribeSubscribers);\r\n\t\t\t}else{\r\n\t\t\t\tpublish(name, event.subscribers, arguments);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\textendedEvent.dont = function(subscriber){\r\n\t\t\tif(unsubscribeFrom(name, event.subscribers, subscriber))\r\n\t\t\t\tpublish(name+\".isUnsubscribedFrom\", event.unsubscribeSubscribers);\r\n\t\t};\r\n\r\n\t\textendedEvent.isSubscribedTo = function(subscriber){\r\n\t\t\tsubscribeTo(name+\".isSubscribedTo\", event.subscribeSubscribers, subscriber);\r\n\t\t};\r\n\r\n\t\textendedEvent.isSubscribedTo.dont = function(subscriber){\r\n\t\t\tunsubscribeFrom(name+\".isSubscribedTo\", event.subscribeSubscribers, subscriber);\r\n\t\t};\r\n\r\n\t\textendedEvent.isUnsubscribedFrom = function(subscriber){\r\n\t\t\tsubscribeTo(name+\".isUnsubscribedFrom\", event.unsubscribeSubscribers, subscriber);\r\n\t\t};\r\n\r\n\t\textendedEvent.isUnsubscribedFrom.dont = function(subscriber){\r\n\t\t\tunsubscribeFrom(name+\".isUnsubscribedFrom\", event.unsubscribeSubscribers, subscriber);\r\n\t\t};\r\n\r\n\t\textendedEvent.toString = function(){\r\n\t\t\treturn \"[Event \"+name+\"]\";\r\n\t\t}\r\n\r\n\t\treturn extendedEvent;\r\n\t}\r\n\t\r\n\tfunction extend(events){\r\n\t\tfor(var i in events){\r\n\t\t\tevents[i] = extendEvent(i, events[i]);\r\n\t\t}\r\n\t\treturn events;\r\n\t}\r\n\r\n\tfunction create(arg1, arg2){\r\n\t\tif(arg2)\r\n\t\t\treturn extendEvent(arg1, arg2);\r\n\t\telse\r\n\t\t\treturn extendEvent(\"anonymous event\", arg1)\r\n\t}\r\n\r\n\treturn {\r\n\t\textend: extend,\r\n\t\tcreate: create\r\n\t};\r\n\t\r\n});\r\n",
    "\ndefine('ordnung/events',['ordnung/proclaimWhen'], function(proclaimWhen){\r\n\treturn proclaimWhen.extend({\r\n\t\tthePageHasChanged: function(path, segments, url){ }\r\n\t});\r\n});",
    "\ndefine('ordnung/spa',[\r\n\t\"ordnung/spa/Outlet\",\r\n\t\"ordnung/spa/whenContext\",\r\n\t\"ordnung/spa/applyViewModels\",\r\n\t\"ordnung/spa/hashNavigation\",\r\n\t\"ordnung/spa/Templates\",\r\n\t\"ordnung/utils\",\r\n\t\"ordnung/events\"\r\n], function(\r\n\tOutlet,\r\n\twhenContext,\r\n\tapplyViewModels,\r\n\thashNavigation,\r\n\tTemplates,\r\n\tutils,\r\n\tproclaim\r\n){\r\n\r\n\tvar _config = {\r\n\t\t\tindex: \"index\"\r\n\t\t},\r\n\t\t_document,\r\n\t\t_outlet,\r\n\t\t_originalTitle,\r\n\t\t_templates,\r\n\t\t_whenContext;\r\n\r\n\tfunction applyContent(content){\r\n\t\t_outlet.unloadCurrentPage();\r\n\t\t_outlet.setPageContent(content);\r\n\t\t_outlet.setDocumentTitle(_outlet.getPageTitle() || _originalTitle);\r\n\t\t_outlet.extractAndRunPageJavaScript();\r\n\t\treturn applyViewModels(_outlet.element, _whenContext());\r\n\t}\r\n\r\n\tfunction pageChanged(path, segments){\r\n\t\t_outlet.indicatePageIsLoading();\r\n\t\t_whenContext.destroyChildContexts();\r\n\t\treturn _templates.getTemplate(path)\r\n\t\t\t.then(applyContent)\r\n\t\t\t.then(function(){\r\n\t\t\t\t_outlet.pageHasLoaded();\r\n\t\t\t\tproclaim.thePageHasChanged(path, segments, document.location)\r\n\t\t\t});\r\n\t}\r\n\r\n\tfunction start(config, document){\r\n\t\t_document = document || window.document;\r\n\t\t_config = utils.extend(_config, config);\r\n\t\t_outlet = new Outlet(_document.querySelector(\"[data-outlet]\"), _document);\r\n\t\t_originalTitle = _document.title;\r\n\t\t_whenContext = whenContext();\r\n\r\n\t\treturn applyViewModels(_document, whenContext()).then(function(){\r\n\t\t\tif(_outlet.outletExists()){\r\n\t\t\t\t_templates = new Templates(_document, _config);\r\n\t\t\t\thashNavigation.start(_config, pageChanged, _document);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn {\r\n\t\tstart: start\r\n\t};\r\n});",
    "\ndefine('ordnung/ordnung',[\r\n  'ordnung/qvc',\r\n  'ordnung/spa'\r\n], function(\r\n  qvc,\r\n  spa\r\n){\r\n\r\n  \r\n\r\n  function config(config){\r\n\r\n    config = config || {};\r\n\r\n    var spaConfig = config.spa || {};\r\n    var qvcConfig = config.qvc || {};\r\n\r\n    qvc.config(qvcConfig);\r\n\r\n    return {\r\n      start: spa.start.bind(null, spaConfig, document)\r\n    }\r\n  }\r\n  \r\n  return {\r\n    config: config\r\n  };\r\n\r\n});\ndefine('ordnung', ['ordnung/ordnung'], function (main) { return main; });\n",
    "\ndefine('ordnung/qvc/constraints/NotEmpty',[], function(){\r\n\tfunction NotEmpty(attributes){\r\n\t\t\r\n\t}\r\n\t\r\n\tNotEmpty.prototype.isValid = function(value){\r\n\t\tif(value == null) return false;\r\n\t\tif(typeof value == \"string\" && value.length == 0) return false;\r\n\t\treturn true;\r\n\t};\r\n\t\r\n\treturn NotEmpty;\r\n});",
    "\ndefine('ordnung/qvc/constraints/Pattern',[], function(){\r\n\tfunction Pattern(attributes){\t\t\r\n\r\n\t\tattributes.flags = attributes.flags || [];\r\n\t\t\r\n\t\tvar flags = '';\r\n\t\tif(attributes.flags.indexOf(\"CASE_INSENSITIVE\") >= 0) flags += 'i';\r\n\t\t\r\n\t\tthis.regex = new RegExp(attributes.regexp, flags);\r\n\t}\r\n\t\r\n\t\r\n\tPattern.prototype.isValid = function(value){\r\n\t\t\r\n\t\tif(value == null) return false;\r\n\t\t\r\n\t\tvar result = this.regex.exec(value);\r\n\t\t\r\n\t\tif(result == null) return false;\r\n\t\t\r\n\t\treturn result[0] == value;\r\n\t};\r\n\t\r\n\t\r\n\treturn Pattern;\r\n});"
  ]
}