define("ordnung/utils",[],function(){return{toArray:function(a){for(var b=[],c=a.length>>>0;c--;)b[c]=a[c];return b},extend:function(a,b){b=b||{},a=a||{};for(var c in b)a[c]=b[c];return a},arrayToObject:function(a,b){return a.reduce(function(a,c){return b(c,a),a},{})},trim:function(a,b){for(;a.charAt(0)==b;)a=a.substr(1);for(;a.charAt(a.length-1)==b;)a=a.substr(0,a.length-1);return a},popTail:function(a){return a.slice(0,-1)},startsWith:function(a,b){return a.charAt(0)===b},endsWith:function(a,b){return a.charAt(a.length-1)===b},addEventListener:function(a,b,c,d){"addEventListener"in a?a.addEventListener(b,c,d):a.attachEvent("on"+b,c)}}}),define("ordnung/qvc/ExecutableResult",["ordnung/utils"],function(a){function b(b){this.success=!1,this.valid=!1,this.result=null,this.exception=null,this.violations=[],a.extend(this,b)}return b}),define("ordnung/qvc/Constraint",[],function(){function a(a,b){this.name=a,this.attributes=b,this.message=b.message,this.init(a)}return a.prototype.init=function(a){require(["ordnung/qvc/constraints/"+a],function(a){var b=new a(this.attributes);this.validate=b.isValid.bind(b)}.bind(this))},a.prototype.validate=function(){return!0},a}),define("ordnung/qvc/Validator",["ordnung/qvc/Constraint","knockout"],function(a,b){function c(){this.constraints=[],this.isValid=b.observable(!0),this.message=b.observable("")}return c.prototype.setConstraints=function(b){this.constraints=b.map(function(b){return new a(b.name,b.attributes)})},c.prototype.reset=function(){this.isValid(!0),this.message("")},c.prototype.validate=function(a){0==this.constraints.length?this.reset():this.constraints.every(function(b){return b.validate(a)?!0:(this.isValid(!1),this.message(b.message),!1)}.bind(this))&&(this.isValid(!0),this.message(""))},c}),define("ordnung/qvc/koExtensions",["ordnung/qvc/Validator","knockout"],function(a,b){null!=b&&(b.bindingHandlers.validationMessageFor={init:function(a,c){var d=c(),e=d.validator;e&&b.applyBindingsToNode(a,{hidden:e.isValid,text:e.message},e)}},b.extenders.validation=function(b,c){return b.validator=new a(b,c),b.subscribe(function(a){b.validator.validate(a)}),b},b.bindingHandlers.command=b.bindingHandlers.query={init:function(a,c,d,e){b.applyBindingsToNode(a,{click:c()},e)}})}),define("ordnung/qvc/Validatable",["ordnung/utils","ordnung/qvc/Validator","knockout","ordnung/qvc/koExtensions"],function(a,b,c){function d(a,b){for(var e in a){var f=a[e];c.isObservable(f)&&(f.extend({validation:{}}),b.push(f)),f=c.utils.unwrapObservable(f),"object"==typeof f&&d(f,b)}}function e(a,b,d){return a.split(".").reduce(function(b,e){var f=b.path,g=c.utils.unwrapObservable(b.field);if(e in g)return{field:g[e],path:f+"."+e};throw new Error(d+": "+a+"\n"+e+" is not a member of "+f+"\n"+f+" = `"+c.toJSON(g)+"`")},{field:b,path:"parameters"}).field}function f(a,b,c){var d=e(b,a,"Error applying violation");if(!("string"==typeof c&&"validator"in d))throw new Error("Error applying violation\n"+b+" is not validatable\nit should be an observable");d.validator.isValid(!1),d.validator.message(c)}function g(a,b){a.validator.isValid(!1);var c=a.validator.message(),d=0==c.length?b:c+", "+b;a.validator.message(d)}function h(a,c,e){var f=this;this.validator=new b,this.validatableFields=[],this.validatableParameters=c,d(f.validatableParameters,f.validatableFields),e&&e.applyValidationConstraints(a,f)}return h.prototype.isValid=function(){return this.validatableFields.every(function(a){return a.validator&&a.validator.isValid()})&&this.validator.isValid()},h.prototype.applyViolations=function(a){a.forEach(function(a){var b=a.message,c=a.fieldName;c.length>0?f(this.validatableParameters,c,b):g(this,b)}.bind(this))},h.prototype.applyConstraints=function(a){var b=this.validatableParameters;a.forEach(function(a){var d=a.name,f=a.constraints,g=e(d,b,"Error applying constraints to field");if(!(c.isObservable(g)&&"validator"in g))throw new Error("Error applying constraints to field: "+d+"\n"+"It is not an observable or is not extended with a validator. \n"+d+"=`"+c.toJSON(g)+"`");g.validator.setConstraints(f)})},h.prototype.validate=function(){this.validator.validate(!0),this.validator.isValid()&&this.validatableFields.forEach(function(a){var b=a.validator;b&&b.validate(a())})},h.prototype.clearValidationMessages=function(){this.validator.reset(),this.validatableFields.forEach(function(a){var b=a.validator;b&&b.reset()})},h}),define("ordnung/qvc/Executable",["ordnung/qvc/ExecutableResult","ordnung/qvc/Validatable","ordnung/utils","knockout"],function(a,b,c,d){function e(e,f,g,h,i){var j=this;this.name,this.type,this.isBusy=d.observable(!1),this.hasError=d.observable(!1),this.result=new a,this.parameters={},this.callbacks={beforeExecute:function(){},canExecute:function(){return!0},error:function(){},success:function(){},result:function(){},complete:function(){}},this.execute=function(){j.onBeforeExecute()!==!1&&i.execute(j)},this.onBeforeExecute=function(){return j.isBusy()?!1:(j.hasError(!1),j.callbacks.beforeExecute(),j.validate(),j.isValid()?j.callbacks.canExecute()===!1?!1:(j.isBusy(!0),!0):!1)},this.onError=function(){j.hasError(!0),"violations"in j.result&&j.applyViolations(j.result.violations),j.callbacks.error(j.result)},this.onSuccess=function(){j.hasError(!1),j.clearValidationMessages(),j.callbacks.success(j.result),j.callbacks.result(j.result.result)},this.onComplete=function(){j.hasError()||(j.callbacks.complete(j.result),j.clearValidationMessages()),j.isBusy(!1)},j.name=e,j.type=f,c.extend(j.parameters,g),c.extend(j.callbacks,h),c.extend(j,new b(j.name,j.parameters,i.constraintResolver))}return e.Command="command",e.Query="query",e}),define("ordnung/ajax",[],function(){function a(a){var b=[];for(var c in a){var d=a[c];b.push(c+"="+encodeURIComponent(d))}return b.join("&")}function b(a,b,c){return a+(a.match(/\?/)?a.match(/&$/)?"":"&":"?")+encodeURIComponent(b)+"="+encodeURIComponent(c)}function c(a,b){return a+(a.match(/\/$/)?"":"/")+b}function d(c,d,e,f){var g=new XMLHttpRequest,h="POST"===e,i=null;return d&&(h?i=a(d):c+="?"+a(d)),h&&(c=b(c,"cacheKey",Math.floor(1e4*Math.random()))),g.open(h?"POST":"GET",c,!0),h&&i&&(g.setRequestHeader("Content-type","application/x-www-form-urlencoded"),g.setRequestHeader("Content-length",i.length),g.setRequestHeader("Connection","close")),g.setRequestHeader("X-Requested-With","XMLHttpRequest"),g.onreadystatechange=function(){4==g.readyState&&f(g)},g.send(i),g}return d.addParamToUrl=b,d.addToPath=c,d}),define("ordnung/qvc/ConstraintResolver",[],function(){function a(a,b){for(var c=0;c<b.length;c++)if(b[c].name==a)return b[c];return!1}function b(b,c){var d=a(b,this.constraints);d&&(d.validatables.forEach(function(a){a.applyConstraints(c)}),d.fields=c,d.state="loaded")}function c(a){this.qvc=a,this.constraints=[]}return c.prototype.applyValidationConstraints=function(c,d){var e=a(c,this.constraints);0==e?(this.constraints.push({name:c,state:"loading",validatables:[d]}),this.qvc.loadConstraints(c,b.bind(this))):"loading"===e.state?e.validatables.push(d):d.applyConstraints(e.fields)},c}),define("ordnung/qvc",["ordnung/qvc/Executable","ordnung/qvc/ExecutableResult","ordnung/utils","ordnung/ajax","ordnung/qvc/ConstraintResolver","knockout","ordnung/qvc/koExtensions"],function(a,b,c,d,e,f){function g(){var a=this;this.constraintResolver=new e(a),this.execute=function(c){var e=f.toJS(c.parameters),g={parameters:JSON.stringify(e),csrfToken:a.config.csrf},h=d.addToPath(a.config.baseUrl,c.type+"/"+c.name);d(h,g,"POST",function(a){200===a.status?(c.result=new b(JSON.parse(a.responseText||"{}")),c.result.success===!0?c.onSuccess():c.onError()):(c.result=new b({exception:{message:a.responseText,cause:a}}),c.onError()),c.onComplete()})},this.loadConstraints=function(b,c){var e=d.addToPath(a.config.baseUrl,"constraints/"+b);d(e,null,"GET",function(a){if(200===a.status){try{var d=JSON.parse(a.responseText||'{"parameters":[]}');0=="parameters"in d&&(d.parameters=[])}catch(e){var d={parameters:[]}}c(b,d.parameters)}})},this.config={baseUrl:"/",csrf:""}}function h(b,c,d,e){if(null==b||0==b.length)throw new Error(c+" is missing name\nA "+c+" must have a name!\nusage: createCommand('name', [parameters, callbacks])");var g=new a(b,c,d||{},e||{},i),h=g.execute.bind(g);return h.isValid=f.computed(function(){return g.isValid()}),h.isBusy=f.computed(function(){return g.isBusy()}),h.hasError=f.computed(function(){return g.hasError()}),h.success=function(a){return g.callbacks.success=a,h},h.error=function(a){return g.callbacks.error=a,h},h.beforeExecute=function(a){return g.callbacks.beforeExecute=a,h},h.canExecute=function(a){return g.callbacks.canExecute=a,h},h.result=function(){return 1==arguments.length?(g.callbacks.result=arguments[0],h):g.result.result},h.complete=function(a){return g.callbacks.complete=a,h},h.clearValidationMessages=g.clearValidationMessages.bind(g),h}var i=new g;return{createCommand:function(b,c,d){return h(b,a.Command,c,d)},createQuery:function(b,c,d){return h(b,a.Query,c,d)},config:function(a){c.extend(i.config,a)}}}),define("ordnung/spa/Outlet",["knockout"],function(a){function b(a,b){this.element=a,this.document=b||window.document}return b.prototype.outletExists=function(){return null==this.element},b.prototype.unloadCurrentPage=function(){a.cleanNode(this.element),this.element.innerHTML=""},b.prototype.setPageContent=function(a){this.element.innerHTML=a},b.prototype.getPageTitle=function(){var a=this.element.querySelector("meta[name=title]");return a&&a.getAttribute("content")},b.prototype.setDocumentTitle=function(a){this.document.title=a},b.prototype.extractAndRunPageJavaScript=function(){for(var a=this.element.querySelectorAll("script"),b=0;b<a.length;b++){if(a[b].parentNode.removeChild(a[b]),""===a[b].id)throw new Error("The script must have an id");if(null==this.document.getElementById(a[b].id)){var c=this.document.createElement("script");c.id=a[b].id,c.text=a[b].textContent,this.document.body.appendChild(c)}}},b.prototype.indicatePageIsLoading=function(){this.element.setAttribute("data-loading","true")},b.prototype.pageHasLoaded=function(){this.element.setAttribute("data-loading","false")},b}),define("ordnung/spa/EventSubscriber",[],function(){function a(){var a=[];this.unsubscribeAllEvents=function(){for(var b;b=a.pop();)b()},this.subscribe=function(b,c){a.push(function(){b.dont(c)}),b(c)},this.subscribeForever=function(a,b){a(b)}}return a}),define("ordnung/errorHandler",[],function(){return{onError:function(a){console.error(a.stack)}}}),function(a,b){a("when/when",[],function(){function a(a,b,c,e){return d(a).then(b,c,e)}function c(a,b){this._message=a,this.inspect=b}function d(a){return g(function(b){b(a)})}function e(b){return a(b,j)}function f(){function a(a,f,g){b.resolve=b.resolver.resolve=function(b){return e?d(b):(e=!0,a(b),c)},b.reject=b.resolver.reject=function(a){return e?d(j(a)):(e=!0,f(a),c)},b.notify=b.resolver.notify=function(a){return g(a),a}}var b,c,e;return b={promise:Q,resolve:Q,reject:Q,notify:Q,resolver:{resolve:Q,reject:Q,notify:Q}},b.promise=c=g(a),b}function g(a){return h(a,P.PromiseStatus&&P.PromiseStatus())}function h(a,b){function d(a,b,c,d){function e(e){e._message(a,b,c,d)}r?r.push(e):D(function(){e(o)})}function e(){return o?o.inspect():C()}function f(){var a=arguments;return h(function(b,c,e){d("when",a,b,e)},b&&b.observed())}function g(a){r&&(o=m(a),p(r,o),r=Q,b&&q(o,b))}function i(a){g(j(a))}function k(a){r&&p(r,l(a))}var n,o,r=[];n=new c(d,e),n.then=f;try{a(g,i,k)}catch(s){i(s)}return n}function i(a){return k(new n(a),function(){return A(a)})}function j(a){return k(new o(a),function(){return B(a)})}function k(a,b){return new c(function(b,c,d){try{d(a[b].apply(a,c))}catch(e){d(j(e))}},b)}function l(a){return new c(function(b,c,d,e){var f=c[2];try{e("function"==typeof f?f(a):a)}catch(g){e(g)}})}function m(a){return a instanceof c?a:a===Object(a)&&"then"in a?g(function(b,c,d){D(function(){try{var e=a.then;"function"==typeof e?I(e,a,b,c,d):b(i(a))}catch(f){c(f)}})}):i(a)}function n(a){this.value=a}function o(a){this.reason=a}function p(a,b){D(function(){for(var c,d=0;c=a[d++];)c(b)})}function q(a,b){a._message("when",[function(){b.fulfilled()},function(a){b.rejected(a)}],F,F)}function r(a){return a&&"function"==typeof a.then}function s(b,c,d,e,f){return a(b,function(b){function h(d,e,f){function g(a){n(a)}function h(a){m(a)}var i,j,k,l,m,n,o,p;if(o=b.length>>>0,i=Math.max(0,Math.min(c,o)),k=[],j=o-i+1,l=[],i)for(n=function(a){l.push(a),--j||(m=n=F,e(l))},m=function(a){k.push(a),--i||(m=n=F,d(k))},p=0;o>p;++p)p in b&&a(b[p],h,g,f);else d(k)}return g(h).then(d,e,f)})}function t(a,b,c,d){function e(a){return b?b(a[0]):a[0]}return s(a,1,e,c,d)}function u(a,b,c,d){return y(a,F).then(b,c,d)}function v(){return y(arguments,F)}function w(a){return y(a,A,B)}function x(a,b){return y(a,b)}function y(b,c,d){return a(b,function(b){function e(e,f,g){function h(b,h){a(b,c,d).then(function(a){i[h]=a,g(a),--k||e(i)},f)}var i,j,k,l;if(k=j=b.length>>>0,i=[],!k)return e(i),void 0;for(l=0;j>l;l++)l in b?h(b[l],l):--k}return g(e)})}function z(b,c){var d=I(H,arguments,1);return a(b,function(b){var e;return e=b.length,d[0]=function(b,d,f){return a(b,function(b){return a(d,function(a){return c(b,a,f,e)})})},G.apply(b,d)})}function A(a){return{state:"fulfilled",value:a}}function B(a){return{state:"rejected",reason:a}}function C(){return{state:"pending"}}function D(a){1===K.push(a)&&J(E)}function E(){for(var a,b=0;a=K[b++];)a();K=[]}function F(a){return a}a.promise=g,a.resolve=d,a.reject=e,a.defer=f,a.join=v,a.all=u,a.map=x,a.reduce=z,a.settle=w,a.any=t,a.some=s,a.isPromise=r,c.prototype={otherwise:function(a){return this.then(Q,a)},ensure:function(a){function b(){return d(a())}return this.then(b,b).yield(this)},yield:function(a){return this.then(function(){return a})},tap:function(a){return this.then(a).yield(this)},spread:function(a){return this.then(function(b){return u(b,function(b){return a.apply(Q,b)})})},always:function(a,b){return this.then(a,a,b)}},n.prototype.when=function(a){return"function"==typeof a?a(this.value):this.value},o.prototype.when=function(a,b){if("function"==typeof b)return b(this.reason);throw this.reason};var G,H,I,J,K,L,M,N,O,P,Q;if(K=[],L=b.setTimeout,P="undefined"!=typeof console?console:a,"function"==typeof setImmediate)J=setImmediate.bind(b);else if("undefined"!=typeof MessageChannel){var R=new MessageChannel;R.port1.onmessage=E,J=function(){R.port2.postMessage(0)}}else J="object"==typeof process&&process.nextTick?process.nextTick:"object"==typeof vertx?vertx.runOnLoop:function(a){L(a,0)};return M=Function.prototype,N=M.call,I=M.bind?N.bind(N):function(a,b){return a.apply(b,H.call(arguments,2))},O=[],H=O.slice,G=O.reduce||function(a){var b,c,d,e,f;if(f=0,b=Object(this),e=b.length>>>0,c=arguments,c.length<=1)for(;;){if(f in b){d=b[f++];break}if(++f>=e)throw new TypeError}else d=c[1];for(;e>f;++f)f in b&&(d=a(d,b[f],f,b));return d},a})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()},this),define("when",["when/when"],function(a){return a}),function(a){a("when/callbacks",["require","./when"],function(a){function b(a,b){return c(a,this,b)}function c(a,b,c){return j.all(c||[]).then(function(c){return k(function(d,e){var f=c.concat(i(d),i(e));a.apply(b,f)})})}function d(a){return c(a,this,l.call(arguments,1))}function e(a){var b=l.call(arguments,1);return function(){return c(a,this,b.concat(l.call(arguments)))}}function f(a,b){return function(){var c=this;return j.all(arguments).then(function(d){function e(e,f){var i,j;"callback"in b&&(i=g(d,b.callback)),"errback"in b&&(j=g(d,b.errback)),i>j?(h(d,j,f),h(d,i,e)):(h(d,i,e),h(d,j,f)),a.apply(c,d)}return k(e)})}}function g(a,b){return 0>b?a.length+b+2:b}function h(a,b,c){null!=b&&(c=i(c),0>b&&(b=a.length+b+2),a.splice(b,0,c))}function i(a){return function(){arguments.length<=1?a.apply(this,arguments):a.call(this,l.call(arguments))}}var j,k,l;return j=a("./when"),k=j.promise,l=[].slice,{apply:b,call:d,lift:e,bind:e,promisify:f}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),define("ordnung/spa/applyViewModels",["ordnung/utils","ordnung/errorHandler","knockout","when","when/callbacks"],function(a,b,c,d,e){function f(a){var b=a.getAttribute("data-viewmodel"),c=a.getAttribute("data-model");return c&&0==c.indexOf("{")&&(c=JSON.parse(c)),{target:a,viewModelName:b,model:c}}function g(a){return e.call(require,[a.viewModelName]).then(function(b){return a.ViewModel=b,a},function(a){return b.onError(new Error("could not load the following modules: "+a.requireModules)),null})}function h(a,d){try{var e=new d.ViewModel(d.model||{},a);c.applyBindings(e,d.target)}catch(f){b.onError(f)}}function i(a){return null!=a&&null!=a.ViewModel}return function(b,c){b=b||document.body;var e=a.toArray(b.querySelectorAll("*[data-viewmodel]")),j=e.map(f).map(g);return d.all(j).then(function(a){a.filter(i).forEach(h.bind(null,c))})}}),define("ordnung/spa/hashNavigation",["ordnung/utils"],function(a){function b(b,c,d){var e=a.startsWith(c,"/")===!1,f=a.endsWith(c,"/");if("/"===c)var g=[];else if(""===c)var g=[d];else var g=a.trim(c,"/").split("/");f&&g.push(d),e&&(g=a.popTail(b).concat(g));for(var h=[],i=g.length>>>0;i--;)""!==g[i]&&"."!==g[i]&&(".."===g[i]?i--:h.unshift(g[i]));return h}function c(c,d,e){var f=a.trim(e.location.hash,"#"),g=0==a.startsWith(f,"/"),h=a.endsWith(f,"/");if(g||h){var i=b(this.currentPath,f,c.index).join("/");e.location.replace("#/"+i)}else this.currentPath=b(this.currentPath,f,c.index),d(this.currentPath.join("/"))}function d(b,d,e,f){e=e||document,f=f||window;var g={currentPath:[]},h=c.bind(g,b,d,e);return h(),a.addEventListener(f,"hashchange",h,!1),{stop:function(){f.removeEventListener("hashchange",h,!1)}}}return{start:d}}),define("ordnung/spa/PageLoader",["ordnung/ajax"],function(a){function b(a){this.pathToUrl=a,this.currentXHR=null}return b.prototype.loadPage=function(b,c){this.abort(),this.currentXHR=a(this.pathToUrl(b),{},"GET",function(a){200===a.status?c.resolve(a.responseText):c.reject({error:a.status,content:a.responseText})})},b.prototype.abort=function(){this.currentXHR&&4!==this.currentXHR.readyState&&this.currentXHR.abort()},b}),define("ordnung/spa/Templates",["ordnung/spa/PageLoader","ordnung/utils","when"],function(a,b,c){function d(a){var c=a.querySelectorAll("[type='text/page-template']"),d=b.toArray(c),e=d.map(function(a){return{id:a.id.toLowerCase(),content:a.innerHTML}});return b.arrayToObject(e,function(a,b){b[a.id]=a.content})}function e(b,c){this.pageLoader=new a(c&&c.pathToUrl||function(a){return a}),this.templates=d(b)}return e.prototype.getTemplate=function(a){this.pageLoader.abort();var b=a.toLowerCase();if(b in this.templates)return c.resolve(this.templates[b]);var d=c.defer();return this.pageLoader.loadPage(a,d.resolver),d.promise.then(function(a){return a},function(a){var b="error"+a.error;return b in this.templates?this.templates[b]:a.content}.bind(this))},e}),define("ordnung/spa",["ordnung/spa/Outlet","ordnung/spa/EventSubscriber","ordnung/spa/applyViewModels","ordnung/spa/hashNavigation","ordnung/spa/Templates","ordnung/utils"],function(a,b,c,d,e,f){function g(a){return k.unloadCurrentPage(),k.setPageContent(a),k.setDocumentTitle(k.getPageTitle()||l),k.extractAndRunPageJavaScript(),c(k.element,n.subscribe)}function h(a){return k.indicatePageIsLoading(),n.unsubscribeAllEvents(),m.getTemplate(a).then(g).then(function(){k.pageHasLoaded()})}function i(g,i){return j=i||window.document,o=f.extend(o,g),k=new a(j.querySelector("[data-outlet]"),j),l=j.title,n=new b,c(j,n.subscribeForever).then(function(){k.outletExists()&&(m=new e(j,o),d.start(o,h,j))})}var j,k,l,m,n,o={index:"index"};return{start:i}}),define("ordnung/proclaimWhen",[],function(){function a(a,b,c){b.subscribers.forEach(function(a){a.apply(a,c)})}function b(a,b,c){b.subscribers.push(c)}function c(a,b,c){var d=b.subscribers.indexOf(c);b.subscribers.splice(d,1)}function d(d,e){e.subscribers=[];var f=function(){1==arguments.length&&"function"==typeof arguments[0]?b(d,e,arguments[0]):a(d,e,arguments)};return f.dont=function(a){c(d,e,a)},f}function e(a){for(var b in a)a[b]=d(b,a[b]);return a}function f(a,b){return b?d(a,b):d("anonymous event",a)}return{extend:e,create:f}}),define("ordnung/qvc/constraints/NotEmpty",[],function(){function a(){}return a.prototype.isValid=function(a){return null==a?!1:"string"==typeof a&&0==a.length?!1:!0},a}),define("ordnung/qvc/constraints/Pattern",[],function(){function a(a){a.flags=a.flags||[];var b="";a.flags.indexOf("CASE_INSENSITIVE")>=0&&(b+="i"),this.regex=new RegExp(a.regexp,b)}return a.prototype.isValid=function(a){if(null==a)return!1;var b=this.regex.exec(a);return null==b?!1:b[0]==a},a});
//# sourceMappingURL=Dist/ordnung.min.js.map